HybridFunction = AleatoryGeneration,
AleatoryGeneration = HybridFunction,
AleatoryIteration = GreedyPassword,
GreedyPassword = AleatoryIteration
)
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "Tiempo_Hybrid"] <- "Tiempo_AleatoryGen_tmp"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "Tiempo_AleatoryGen"] <- "Tiempo_Hybrid"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "Tiempo_AleatoryGen_tmp"] <- "Tiempo_AleatoryGen"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "Tiempo_AleatoryIter"] <- "Tiempo_Greedy_tmp"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "Tiempo_Greedy"] <- "Tiempo_AleatoryIter"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "Tiempo_Greedy_tmp"] <- "Tiempo_Greedy"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "HybridFunction"] <- "AleatoryGeneration_tmp"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "AleatoryGeneration"] <- "HybridFunction"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "AleatoryGeneration_tmp"] <- "AleatoryGeneration"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "AleatoryIteration"] <- "GreedyPassword_tmp"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "GreedyPassword"] <- "AleatoryIteration"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "GreedyPassword_tmp"] <- "GreedyPassword"
df.claves.Cpp.1.1.entropia <- df.claves.Cpp.1.1.entropia %>%
mutate(
across(all_of(paste0(tipos.entropia, "HybridFunction")),~df.claves.Cpp.1.1.entropia[[sub("HybridFunction", "AleatoryGeneration", cur_column())]]),
across(all_of(paste0(tipos.entropia, "AleatoryGeneration")),~df.claves.Cpp.1.1.entropia[[sub("AleatoryGeneration", "HybridFunction", cur_column())]]),
across(all_of(paste0(tipos.entropia, "AleatoryIteration")),~df.claves.Cpp.1.1.entropia[[sub("AleatoryIteration", "GreedyPassword", cur_column())]]),
across(all_of(paste0(tipos.entropia, "GreedyPassword")),~df.claves.Cpp.1.1.entropia[[sub("GreedyPassword", "AleatoryIteration", cur_column())]]),
Tiempo_Hybrid = Tiempo_AleatoryGen,
Tiempo_AleatoryGen = Tiempo_Hybrid,
Tiempo_AleatoryIter = Tiempo_Greedy,
Tiempo_Greedy = Tiempo_AleatoryIter,
HybridFunction = AleatoryGeneration,
AleatoryGeneration = HybridFunction,
AleatoryIteration = GreedyPassword,
GreedyPassword = AleatoryIteration
)
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "Tiempo_Hybrid"] <- "Tiempo_AleatoryGen_tmp"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "Tiempo_AleatoryGen"] <- "Tiempo_Hybrid"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "Tiempo_AleatoryGen_tmp"] <- "Tiempo_AleatoryGen"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "Tiempo_AleatoryIter"] <- "Tiempo_Greedy_tmp"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "Tiempo_Greedy"] <- "Tiempo_AleatoryIter"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "Tiempo_Greedy_tmp"] <- "Tiempo_Greedy"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "HybridFunction"] <- "AleatoryGeneration_tmp"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "AleatoryGeneration"] <- "HybridFunction"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "AleatoryGeneration_tmp"] <- "AleatoryGeneration"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "AleatoryIteration"] <- "GreedyPassword_tmp"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "GreedyPassword"] <- "AleatoryIteration"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "GreedyPassword_tmp"] <- "GreedyPassword"
resumen.df <- function(df) {
num.cols <- df[sapply(df, is.numeric)]
estadisticas <- rbind(
media       = colMeans(num.cols, na.rm = TRUE),
mediana     = apply(num.cols, 2, median, na.rm = TRUE),
desviacion  = apply(num.cols, 2, sd, na.rm = TRUE),
minimo      = apply(num.cols, 2, min, na.rm = TRUE),
maximo      = apply(num.cols, 2, max, na.rm = TRUE),
rango       = apply(num.cols, 2, function(x) diff(range(x, na.rm = TRUE))),
Q1          = apply(num.cols, 2, quantile, probs = 0.25, na.rm = TRUE),
Q3          = apply(num.cols, 2, quantile, probs = 0.75, na.rm = TRUE),
NA.contador = apply(num.cols, 2, function(x) sum(is.na(x)))
)
resumen <- data.frame(
datos = rownames(estadisticas),
estadisticas,
check.names = FALSE
)
return(resumen)
}
df.R.1.1.resumen          <- resumen.df(df.R.1.1.entropia)
df.Cpp.1.1.resumen        <- resumen.df(df.Cpp.1.1.entropia)
df.claves.R.1.1.resumen   <- resumen.df(df.claves.R.1.1.entropia)
df.claves.Cpp.1.1.resumen <- resumen.df(df.claves.Cpp.1.1.entropia)
library(ggplot2)
library(reshape2)
plot.entropy <- function(df, prefix, df.name) {
cols.prefijo <- names(df)[grepl(paste0("^", prefix), names(df)) & sapply(df, is.numeric)]
if (length(cols.prefijo) == 0) return(NULL)
df.long <- melt(df[, cols.prefijo], variable.name = "variable", value.name = "valor")
cols <- c("#FFB3BA", "#FFDFBA", "#FFFFBA", "#BAFFC9", "#BAE1FF", "#E1BAFF")
plot <- ggplot(df.long, aes(x = variable, y = valor, fill = variable)) +
stat_boxplot(geom = "errorbar", width = 0.25) +
geom_boxplot(alpha = 0.8, colour = "#474747", outlier.colour = "#D32F2F", ) +
scale_fill_manual(values = cols) +
ggtitle(paste("Distribución de", prefix, "en", df.name)) +
theme_minimal() +
theme(legend.position = "top") +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank()) +
theme(legend.text = element_text(size = 14), legend.title = element_text(size = 16))
ggsave(filename = paste0("plot_", df.name, "_", prefix, ".png"), plot = plot, width = 12, height = 6, dpi = 300)
}
plots.R <- lapply(tipos.entropia, function(pref) plot.entropy(df.R.1.1.entropia, pref, "df.R.1.1.entropia"))
names(plots.R) <- tipos.entropia
plots.Cpp <- lapply(tipos.entropia, function(pref) plot.entropy(df.Cpp.1.1.entropia, pref, "df.Cpp.1.1.entropia"))
names(plots.Cpp) <- tipos.entropia
plots.claves.R <- lapply(tipos.entropia, function(pref) plot.entropy(df.claves.R.1.1.entropia, pref, "df.claves.R.1.1.entropia"))
names(plots.claves.R) <- tipos.entropia
plots.claves.Cpp <- lapply(tipos.entropia, function(pref) plot.entropy(df.claves.Cpp.1.1.entropia, pref, "df.claves.Cpp.1.1.entropia"))
names(plots.claves.Cpp) <- tipos.entropia
carpeta.datos <- "C:/Users/antho/Documents/UCR/CA0204/Proyecto_Individual/datos"
df.R.1.1.entropia <- read.csv(file.path(carpeta.datos, "copilot_claves_R_1_1_entropia.csv"),stringsAsFactors = FALSE)
df.Cpp.1.1.entropia <- read.csv(file.path(carpeta.datos, "copilot_claves_C++_1_1_entropia.csv"),stringsAsFactors = FALSE)
df.claves.R.1.1.entropia <- read.csv(file.path(carpeta.datos, "copilot_claves_claves_R_1_1_entropia.csv"),stringsAsFactors = FALSE)
df.claves.Cpp.1.1.entropia <- read.csv(file.path(carpeta.datos, "copilot_claves_claves_C++_1_1_entropia.csv"),stringsAsFactors = FALSE)
library(dplyr)
tipos.entropia <- c("entropy_normalized_", "entropy_density_", "entropy_effective_", "entropy_shannon_", "entropy_min_", "entropy_quadratic_")
df.Cpp.1.1.entropia <- df.Cpp.1.1.entropia %>%
mutate(
across(all_of(paste0(tipos.entropia, "HybridFunction")),~df.Cpp.1.1.entropia[[sub("HybridFunction", "AleatoryGeneration", cur_column())]]),
across(all_of(paste0(tipos.entropia, "AleatoryGeneration")),~df.Cpp.1.1.entropia[[sub("AleatoryGeneration", "HybridFunction", cur_column())]]),
across(all_of(paste0(tipos.entropia, "AleatoryIteration")),~df.Cpp.1.1.entropia[[sub("AleatoryIteration", "GreedyPassword", cur_column())]]),
across(all_of(paste0(tipos.entropia, "GreedyPassword")),~df.Cpp.1.1.entropia[[sub("GreedyPassword", "AleatoryIteration", cur_column())]]),
Tiempo_Hybrid = Tiempo_AleatoryGen,
Tiempo_AleatoryGen = Tiempo_Hybrid,
Tiempo_AleatoryIter = Tiempo_Greedy,
Tiempo_Greedy = Tiempo_AleatoryIter,
HybridFunction = AleatoryGeneration,
AleatoryGeneration = HybridFunction,
AleatoryIteration = GreedyPassword,
GreedyPassword = AleatoryIteration
)
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "Tiempo_Hybrid"] <- "Tiempo_AleatoryGen_tmp"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "Tiempo_AleatoryGen"] <- "Tiempo_Hybrid"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "Tiempo_AleatoryGen_tmp"] <- "Tiempo_AleatoryGen"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "Tiempo_AleatoryIter"] <- "Tiempo_Greedy_tmp"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "Tiempo_Greedy"] <- "Tiempo_AleatoryIter"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "Tiempo_Greedy_tmp"] <- "Tiempo_Greedy"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "HybridFunction"] <- "AleatoryGeneration_tmp"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "AleatoryGeneration"] <- "HybridFunction"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "AleatoryGeneration_tmp"] <- "AleatoryGeneration"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "AleatoryIteration"] <- "GreedyPassword_tmp"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "GreedyPassword"] <- "AleatoryIteration"
names(df.Cpp.1.1.entropia)[names(df.Cpp.1.1.entropia) == "GreedyPassword_tmp"] <- "GreedyPassword"
df.claves.Cpp.1.1.entropia <- df.claves.Cpp.1.1.entropia %>%
mutate(
across(all_of(paste0(tipos.entropia, "HybridFunction")),~df.claves.Cpp.1.1.entropia[[sub("HybridFunction", "AleatoryGeneration", cur_column())]]),
across(all_of(paste0(tipos.entropia, "AleatoryGeneration")),~df.claves.Cpp.1.1.entropia[[sub("AleatoryGeneration", "HybridFunction", cur_column())]]),
across(all_of(paste0(tipos.entropia, "AleatoryIteration")),~df.claves.Cpp.1.1.entropia[[sub("AleatoryIteration", "GreedyPassword", cur_column())]]),
across(all_of(paste0(tipos.entropia, "GreedyPassword")),~df.claves.Cpp.1.1.entropia[[sub("GreedyPassword", "AleatoryIteration", cur_column())]]),
Tiempo_Hybrid = Tiempo_AleatoryGen,
Tiempo_AleatoryGen = Tiempo_Hybrid,
Tiempo_AleatoryIter = Tiempo_Greedy,
Tiempo_Greedy = Tiempo_AleatoryIter,
HybridFunction = AleatoryGeneration,
AleatoryGeneration = HybridFunction,
AleatoryIteration = GreedyPassword,
GreedyPassword = AleatoryIteration
)
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "Tiempo_Hybrid"] <- "Tiempo_AleatoryGen_tmp"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "Tiempo_AleatoryGen"] <- "Tiempo_Hybrid"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "Tiempo_AleatoryGen_tmp"] <- "Tiempo_AleatoryGen"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "Tiempo_AleatoryIter"] <- "Tiempo_Greedy_tmp"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "Tiempo_Greedy"] <- "Tiempo_AleatoryIter"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "Tiempo_Greedy_tmp"] <- "Tiempo_Greedy"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "HybridFunction"] <- "AleatoryGeneration_tmp"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "AleatoryGeneration"] <- "HybridFunction"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "AleatoryGeneration_tmp"] <- "AleatoryGeneration"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "AleatoryIteration"] <- "GreedyPassword_tmp"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "GreedyPassword"] <- "AleatoryIteration"
names(df.claves.Cpp.1.1.entropia)[names(df.claves.Cpp.1.1.entropia) == "GreedyPassword_tmp"] <- "GreedyPassword"
resumen.df <- function(df) {
num.cols <- df[sapply(df, is.numeric)]
estadisticas <- rbind(
media       = colMeans(num.cols, na.rm = TRUE),
mediana     = apply(num.cols, 2, median, na.rm = TRUE),
desviacion  = apply(num.cols, 2, sd, na.rm = TRUE),
minimo      = apply(num.cols, 2, min, na.rm = TRUE),
maximo      = apply(num.cols, 2, max, na.rm = TRUE),
rango       = apply(num.cols, 2, function(x) diff(range(x, na.rm = TRUE))),
Q1          = apply(num.cols, 2, quantile, probs = 0.25, na.rm = TRUE),
Q3          = apply(num.cols, 2, quantile, probs = 0.75, na.rm = TRUE),
NA.contador = apply(num.cols, 2, function(x) sum(is.na(x)))
)
resumen <- data.frame(
datos = rownames(estadisticas),
estadisticas,
check.names = FALSE
)
return(resumen)
}
df.R.1.1.resumen          <- resumen.df(df.R.1.1.entropia)
df.Cpp.1.1.resumen        <- resumen.df(df.Cpp.1.1.entropia)
df.claves.R.1.1.resumen   <- resumen.df(df.claves.R.1.1.entropia)
df.claves.Cpp.1.1.resumen <- resumen.df(df.claves.Cpp.1.1.entropia)
plot.entropy <- function(df, prefix, df.name) {
cols.prefijo <- names(df)[grepl(paste0("^", prefix), names(df)) & sapply(df, is.numeric)]
if (length(cols.prefijo) == 0) return(NULL)
df.long <- melt(df[, cols.prefijo], variable.name = "variable", value.name = "valor")
cols <- c("#FFB3BA", "#FFDFBA", "#FFFFBA", "#BAFFC9", "#BAE1FF", "#E1BAFF")
plot <- ggplot(df.long, aes(x = variable, y = valor, fill = variable)) +
stat_boxplot(geom = "errorbar", width = 0.25) +
geom_boxplot(alpha = 0.8, colour = "#474747", outlier.colour = "#D32F2F", ) +
scale_fill_manual(values = cols) +
ggtitle(paste("Distribución de", prefix, "en", df.name)) +
theme_minimal() +
theme(legend.position = "top") +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank()) +
theme(legend.text = element_text(size = 14), legend.title = element_text(size = 16))
ggsave(filename = paste0("plot_", df.name, "_", prefix, ".png"), plot = plot, width = 12, height = 6, dpi = 300)
}
plots.R <- lapply(tipos.entropia, function(pref) plot.entropy(df.R.1.1.entropia, pref, "df.R.1.1.entropia"))
names(plots.R) <- tipos.entropia
plots.Cpp <- lapply(tipos.entropia, function(pref) plot.entropy(df.Cpp.1.1.entropia, pref, "df.Cpp.1.1.entropia"))
names(plots.Cpp) <- tipos.entropia
plots.claves.R <- lapply(tipos.entropia, function(pref) plot.entropy(df.claves.R.1.1.entropia, pref, "df.claves.R.1.1.entropia"))
names(plots.claves.R) <- tipos.entropia
plots.claves.Cpp <- lapply(tipos.entropia, function(pref) plot.entropy(df.claves.Cpp.1.1.entropia, pref, "df.claves.Cpp.1.1.entropia"))
names(plots.claves.Cpp) <- tipos.entropia
View(df.claves.Cpp.1.1.entropia)
View(df.claves.Cpp.1.1.entropia)
carpeta.datos <- "C:/Users/antho/Documents/UCR/CA0204/Proyecto_Individual/datos"
df.R.1.1.entropia <- read.csv(file.path(carpeta.datos, "copilot_claves_R_1_1_entropia.csv"),stringsAsFactors = FALSE)
df.Cpp.1.1.entropia <- read.csv(file.path(carpeta.datos, "copilot_claves_C++_1_1_entropia.csv"),stringsAsFactors = FALSE)
df.claves.R.1.1.entropia <- read.csv(file.path(carpeta.datos, "copilot_claves_claves_R_1_1_entropia.csv"),stringsAsFactors = FALSE)
df.claves.Cpp.1.1.entropia <- read.csv(file.path(carpeta.datos, "copilot_claves_claves_C++_1_1_entropia.csv"),stringsAsFactors = FALSE)
names(df.Cpp.1.1.entropia)
carpeta.datos <- "C:/Users/antho/Documents/UCR/CA0204/Proyecto_Individual/datos"
df.R.1.1.entropia <- read.csv(file.path(carpeta.datos, "copilot_claves_R_1_1_entropia.csv"),stringsAsFactors = FALSE)
df.Cpp.1.1.entropia <- read.csv(file.path(carpeta.datos, "copilot_claves_C++_1_1_entropia.csv"),stringsAsFactors = FALSE)
df.claves.R.1.1.entropia <- read.csv(file.path(carpeta.datos, "copilot_claves_claves_R_1_1_entropia.csv"),stringsAsFactors = FALSE)
df.claves.Cpp.1.1.entropia <- read.csv(file.path(carpeta.datos, "copilot_claves_claves_C++_1_1_entropia.csv"),stringsAsFactors = FALSE)
library(dplyr)
tipos.entropia <- c("entropy_normalized_", "entropy_density_", "entropy_effective_", "entropy_shannon_", "entropy_min_", "entropy_quadratic_")
df.Cpp.1.1.entropia <- df.Cpp.1.1.entropia %>%
mutate(
across(all_of(paste0(tipos.entropia, "HybridFunction")),~df.Cpp.1.1.entropia[[sub("HybridFunction", "AleatoryGeneration", cur_column())]]),
across(all_of(paste0(tipos.entropia, "AleatoryGeneration")),~df.Cpp.1.1.entropia[[sub("AleatoryGeneration", "HybridFunction", cur_column())]]),
across(all_of(paste0(tipos.entropia, "AleatoryIteration")),~df.Cpp.1.1.entropia[[sub("AleatoryIteration", "GreedyPassword", cur_column())]]),
across(all_of(paste0(tipos.entropia, "GreedyPassword")),~df.Cpp.1.1.entropia[[sub("GreedyPassword", "AleatoryIteration", cur_column())]]),
Tiempo_Hybrid = Tiempo_AleatoryGen,
Tiempo_AleatoryGen = Tiempo_Hybrid,
Tiempo_AleatoryIter = Tiempo_Greedy,
Tiempo_Greedy = Tiempo_AleatoryIter,
HybridFunction = AleatoryGeneration,
AleatoryGeneration = HybridFunction,
AleatoryIteration = GreedyPassword,
GreedyPassword = AleatoryIteration
) %>%
rename_with(~sub("HybridFunction", "AleatoryGeneration_tmp", .x),
all_of(paste0(tipos.entropia, "HybridFunction"))) %>%
rename_with(~sub("AleatoryGeneration", "HybridFunction", .x),
all_of(paste0(tipos.entropia, "AleatoryGeneration"))) %>%
rename_with(~sub("AleatoryGeneration_tmp", "AleatoryGeneration", .x),
all_of(paste0(tipos.entropia, "AleatoryGeneration_tmp"))) %>%
rename_with(~sub("AleatoryIteration", "GreedyPassword_tmp", .x),
all_of(paste0(tipos.entropia, "AleatoryIteration"))) %>%
rename_with(~sub("GreedyPassword", "AleatoryIteration", .x),
all_of(paste0(tipos.entropia, "GreedyPassword"))) %>%
rename_with(~sub("GreedyPassword_tmp", "GreedyPassword", .x),
all_of(paste0(tipos.entropia, "GreedyPassword_tmp")))
df.claves.Cpp.1.1.entropia <- df.claves.Cpp.1.1.entropia %>%
mutate(
across(all_of(paste0(tipos.entropia, "HybridFunction")),~df.claves.Cpp.1.1.entropia[[sub("HybridFunction", "AleatoryGeneration", cur_column())]]),
across(all_of(paste0(tipos.entropia, "AleatoryGeneration")),~df.claves.Cpp.1.1.entropia[[sub("AleatoryGeneration", "HybridFunction", cur_column())]]),
across(all_of(paste0(tipos.entropia, "AleatoryIteration")),~df.claves.Cpp.1.1.entropia[[sub("AleatoryIteration", "GreedyPassword", cur_column())]]),
across(all_of(paste0(tipos.entropia, "GreedyPassword")),~df.claves.Cpp.1.1.entropia[[sub("GreedyPassword", "AleatoryIteration", cur_column())]]),
Tiempo_Hybrid = Tiempo_AleatoryGen,
Tiempo_AleatoryGen = Tiempo_Hybrid,
Tiempo_AleatoryIter = Tiempo_Greedy,
Tiempo_Greedy = Tiempo_AleatoryIter,
HybridFunction = AleatoryGeneration,
AleatoryGeneration = HybridFunction,
AleatoryIteration = GreedyPassword,
GreedyPassword = AleatoryIteration
) %>%
rename_with(~sub("HybridFunction", "AleatoryGeneration_tmp", .x),
all_of(paste0(tipos.entropia, "HybridFunction"))) %>%
rename_with(~sub("AleatoryGeneration", "HybridFunction", .x),
all_of(paste0(tipos.entropia, "AleatoryGeneration"))) %>%
rename_with(~sub("AleatoryGeneration_tmp", "AleatoryGeneration", .x),
all_of(paste0(tipos.entropia, "AleatoryGeneration_tmp"))) %>%
rename_with(~sub("AleatoryIteration", "GreedyPassword_tmp", .x),
all_of(paste0(tipos.entropia, "AleatoryIteration"))) %>%
rename_with(~sub("GreedyPassword", "AleatoryIteration", .x),
all_of(paste0(tipos.entropia, "GreedyPassword"))) %>%
rename_with(~sub("GreedyPassword_tmp", "GreedyPassword", .x),
all_of(paste0(tipos.entropia, "GreedyPassword_tmp")))
resumen.df <- function(df) {
num.cols <- df[sapply(df, is.numeric)]
estadisticas <- rbind(
media       = colMeans(num.cols, na.rm = TRUE),
mediana     = apply(num.cols, 2, median, na.rm = TRUE),
desviacion  = apply(num.cols, 2, sd, na.rm = TRUE),
minimo      = apply(num.cols, 2, min, na.rm = TRUE),
maximo      = apply(num.cols, 2, max, na.rm = TRUE),
rango       = apply(num.cols, 2, function(x) diff(range(x, na.rm = TRUE))),
Q1          = apply(num.cols, 2, quantile, probs = 0.25, na.rm = TRUE),
Q3          = apply(num.cols, 2, quantile, probs = 0.75, na.rm = TRUE),
NA.contador = apply(num.cols, 2, function(x) sum(is.na(x)))
)
resumen <- data.frame(
datos = rownames(estadisticas),
estadisticas,
check.names = FALSE
)
return(resumen)
}
df.R.1.1.resumen          <- resumen.df(df.R.1.1.entropia)
df.Cpp.1.1.resumen        <- resumen.df(df.Cpp.1.1.entropia)
df.claves.R.1.1.resumen   <- resumen.df(df.claves.R.1.1.entropia)
df.claves.Cpp.1.1.resumen <- resumen.df(df.claves.Cpp.1.1.entropia)
library(ggplot2)
library(reshape2)
plot.entropy <- function(df, prefix, df.name) {
cols.prefijo <- names(df)[grepl(paste0("^", prefix), names(df)) & sapply(df, is.numeric)]
if (length(cols.prefijo) == 0) return(NULL)
df.long <- melt(df[, cols.prefijo], variable.name = "variable", value.name = "valor")
cols <- c("#FFB3BA", "#FFDFBA", "#FFFFBA", "#BAFFC9", "#BAE1FF", "#E1BAFF")
plot <- ggplot(df.long, aes(x = variable, y = valor, fill = variable)) +
stat_boxplot(geom = "errorbar", width = 0.25) +
geom_boxplot(alpha = 0.8, colour = "#474747", outlier.colour = "#D32F2F", ) +
scale_fill_manual(values = cols) +
ggtitle(paste("Distribución de", prefix, "en", df.name)) +
theme_minimal() +
theme(legend.position = "top") +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank()) +
theme(legend.text = element_text(size = 14), legend.title = element_text(size = 16))
ggsave(filename = paste0("plot_", df.name, "_", prefix, ".png"), plot = plot, width = 12, height = 6, dpi = 300)
}
plots.R <- lapply(tipos.entropia, function(pref) plot.entropy(df.R.1.1.entropia, pref, "df.R.1.1.entropia"))
names(plots.R) <- tipos.entropia
plots.Cpp <- lapply(tipos.entropia, function(pref) plot.entropy(df.Cpp.1.1.entropia, pref, "df.Cpp.1.1.entropia"))
names(plots.Cpp) <- tipos.entropia
plots.claves.R <- lapply(tipos.entropia, function(pref) plot.entropy(df.claves.R.1.1.entropia, pref, "df.claves.R.1.1.entropia"))
names(plots.claves.R) <- tipos.entropia
plots.claves.Cpp <- lapply(tipos.entropia, function(pref) plot.entropy(df.claves.Cpp.1.1.entropia, pref, "df.claves.Cpp.1.1.entropia"))
names(plots.claves.Cpp) <- tipos.entropia
extremos.entropia <- function(resumen, tipos.entropia) {
resultados <- data.frame()
for (tipo in tipos.entropia) {
cols.tipo <- grep(paste0("^", tipo), colnames(resumen), value = TRUE)
if (length(cols.tipo) > 0) {
medias   <- resumen[resumen$datos == "media", cols.tipo, drop = FALSE]
medianas <- resumen[resumen$datos == "mediana", cols.tipo, drop = FALSE]
max.media.col   <- names(medias)[which.max(medias)]
min.media.col   <- names(medias)[which.min(medias)]
max.mediana.col <- names(medianas)[which.max(medianas)]
min.mediana.col <- names(medianas)[which.min(medianas)]
resultados <- rbind(resultados, data.frame(
tipo.entropia = tipo,
media_max_col = max.media.col,
media_max_val = max(medias),
media_min_col = min.media.col,
media_min_val = min(medias),
mediana_max_col = max.mediana.col,
mediana_max_val = max(medianas),
mediana_min_col = min.mediana.col,
mediana_min_val = min(medianas),
row.names = NULL
))
}
}
return(resultados)
}
extremos.R   <- extremos.entropia(df.R.1.1.resumen, tipos.entropia)
extremos.claves.R <- extremos.entropia(df.claves.R.1.1.resumen, tipos.entropia)
extremos.Cpp <- extremos.entropia(df.Cpp.1.1.resumen, tipos.entropia)
extremos.claves.Cpp <- extremos.entropia(df.claves.Cpp.1.1.resumen, tipos.entropia)
extremos.tiempo <- function(resumen) {
resultados <- data.frame()
cols.tiempo <- grep("^(tiempo|Tiempo)", colnames(resumen), value = TRUE)
if (length(cols.tiempo) > 1) {
medias   <- resumen[resumen$datos == "media", cols.tiempo, drop = FALSE]
medianas <- resumen[resumen$datos == "mediana", cols.tiempo, drop = FALSE]
orden.medias   <- sort(unlist(medias), decreasing = TRUE)
orden.medianas <- sort(unlist(medianas), decreasing = TRUE)
max.media.cols   <- names(orden.medias)[1:2]
max.media.vals   <- orden.medias[1:2]
min.media.cols   <- names(orden.medias)[(length(orden.medias)-1):length(orden.medias)]
min.media.vals   <- orden.medias[(length(orden.medias)-1):length(orden.medias)]
max.mediana.cols <- names(orden.medianas)[1:2]
max.mediana.vals <- orden.medianas[1:2]
min.mediana.cols <- names(orden.medianas)[(length(orden.medianas)-1):length(orden.medianas)]
min.mediana.vals <- orden.medianas[(length(orden.medianas)-1):length(orden.medianas)]
resultados <- data.frame(
media_max_col1   = max.media.cols[1],
media_max_val1   = max.media.vals[1],
media_max_col2   = max.media.cols[2],
media_max_val2   = max.media.vals[2],
media_min_col1   = min.media.cols[1],
media_min_val1   = min.media.vals[1],
media_min_col2   = min.media.cols[2],
media_min_val2   = min.media.vals[2],
mediana_max_col1 = max.mediana.cols[1],
mediana_max_val1 = max.mediana.vals[1],
mediana_max_col2 = max.mediana.cols[2],
mediana_max_val2 = max.mediana.vals[2],
mediana_min_col1 = min.mediana.cols[1],
mediana_min_val1 = min.mediana.vals[1],
mediana_min_col2 = min.mediana.cols[2],
mediana_min_val2 = min.mediana.vals[2],
row.names = NULL
)
}
return(resultados)
}
extremos.tiempo.R   <- extremos.tiempo(df.R.1.1.resumen)
extremos.tiempo.claves.R <- extremos.tiempo(df.claves.R.1.1.resumen)
extremos.tiempo.Cpp <- extremos.tiempo(df.Cpp.1.1.resumen)
extremos.tiempo.claves.Cpp <- extremos.tiempo(df.claves.Cpp.1.1.resumen)
extremos.R
extremos.claves.R
extremos.Cpp
extremos.claves.Cpp
extremos.tiempo.R
extremos.tiempo.claves.R
extremos.tiempo.Cpp
extremos.tiempo.claves.Cpp
plot.tiempo <- function(df, df.name) {
cols.tiempo <- names(df)[grepl("^(tiempo|Tiempo)", names(df)) & sapply(df, is.numeric)]
if (length(cols.tiempo) == 0) return(NULL)
df.long <- melt(df[, cols.tiempo], variable.name = "variable", value.name = "valor")
cols <- c("#FFB3BA", "#FFDFBA", "#FFFFBA", "#BAFFC9", "#BAE1FF", "#E1BAFF")
plot <- ggplot(df.long, aes(x = variable, y = valor, fill = variable)) +
stat_boxplot(geom = "errorbar", width = 0.25) +
geom_boxplot(alpha = 0.8, colour = "#474747", outlier.colour = "#D32F2F") +
scale_fill_manual(values = cols) +
scale_y_log10() +
ggtitle(paste("Distribucion de tiempos en", df.name)) +
theme_minimal() +
theme(legend.position = "top", axis.text.x = element_blank(), axis.ticks.x = element_blank(), legend.text = element_text(size = 14), legend.title = element_text(size = 16)
)
ggsave(filename = paste0("plot_", df.name, "_tiempos.png"), plot = plot, width = 12, height = 6, dpi = 300)
return(plot)
}
plot.tiempo(df.R.1.1.entropia, "df.R.1.1.entropia")
plot.tiempo(df.Cpp.1.1.entropia, "df.Cpp.1.1.entropia")
plot.tiempo(df.claves.R.1.1.entropia, "df.claves.R.1.1.entropia")
plot.tiempo(df.claves.Cpp.1.1.entropia, "df.claves.Cpp.1.1.entropia")
carpeta.datos <- "C:/Users/antho/Documents/UCR/CA0204/Proyecto_Individual/datos"
df.R.1.1.entropia <- read.csv(file.path(carpeta.datos, "copilot_claves_R_1_1_entropia.csv"),stringsAsFactors = FALSE)
df.Cpp.1.1.entropia <- read.csv(file.path(carpeta.datos, "copilot_claves_C++_1_1_entropia.csv"),stringsAsFactors = FALSE)
df.claves.R.1.1.entropia <- read.csv(file.path(carpeta.datos, "copilot_claves_claves_R_1_1_entropia.csv"),stringsAsFactors = FALSE)
df.claves.Cpp.1.1.entropia <- read.csv(file.path(carpeta.datos, "copilot_claves_claves_C++_1_1_entropia.csv"),stringsAsFactors = FALSE)
library(dplyr)
tipos.entropia <- c("entropy_normalized_", "entropy_density_", "entropy_effective_", "entropy_shannon_", "entropy_min_", "entropy_quadratic_")
ruta <- "C:/Users/antho/Documents/UCR/CA0204/Proyecto_Individual/datos/"
df.Cpp.1.1.entropia <- df.Cpp.1.1.entropia %>%
mutate(
across(all_of(paste0(tipos.entropia, "HybridFunction")),~df.Cpp.1.1.entropia[[sub("HybridFunction", "AleatoryGeneration", cur_column())]]),
across(all_of(paste0(tipos.entropia, "AleatoryGeneration")),~df.Cpp.1.1.entropia[[sub("AleatoryGeneration", "HybridFunction", cur_column())]]),
across(all_of(paste0(tipos.entropia, "AleatoryIteration")),~df.Cpp.1.1.entropia[[sub("AleatoryIteration", "GreedyPassword", cur_column())]]),
across(all_of(paste0(tipos.entropia, "GreedyPassword")),~df.Cpp.1.1.entropia[[sub("GreedyPassword", "AleatoryIteration", cur_column())]]),
Tiempo_Hybrid = Tiempo_AleatoryGen,
Tiempo_AleatoryGen = Tiempo_Hybrid,
Tiempo_AleatoryIter = Tiempo_Greedy,
Tiempo_Greedy = Tiempo_AleatoryIter,
HybridFunction = AleatoryGeneration,
AleatoryGeneration = HybridFunction,
AleatoryIteration = GreedyPassword,
GreedyPassword = AleatoryIteration
) %>%
rename_with(~sub("HybridFunction", "AleatoryGeneration_tmp", .x),
all_of(paste0(tipos.entropia, "HybridFunction"))) %>%
rename_with(~sub("AleatoryGeneration", "HybridFunction", .x),
all_of(paste0(tipos.entropia, "AleatoryGeneration"))) %>%
rename_with(~sub("AleatoryGeneration_tmp", "AleatoryGeneration", .x),
all_of(paste0(tipos.entropia, "AleatoryGeneration_tmp"))) %>%
rename_with(~sub("AleatoryIteration", "GreedyPassword_tmp", .x),
all_of(paste0(tipos.entropia, "AleatoryIteration"))) %>%
rename_with(~sub("GreedyPassword", "AleatoryIteration", .x),
all_of(paste0(tipos.entropia, "GreedyPassword"))) %>%
rename_with(~sub("GreedyPassword_tmp", "GreedyPassword", .x),
all_of(paste0(tipos.entropia, "GreedyPassword_tmp")))
df.claves.Cpp.1.1.entropia <- df.claves.Cpp.1.1.entropia %>%
mutate(
across(all_of(paste0(tipos.entropia, "HybridFunction")),~df.claves.Cpp.1.1.entropia[[sub("HybridFunction", "AleatoryGeneration", cur_column())]]),
across(all_of(paste0(tipos.entropia, "AleatoryGeneration")),~df.claves.Cpp.1.1.entropia[[sub("AleatoryGeneration", "HybridFunction", cur_column())]]),
across(all_of(paste0(tipos.entropia, "AleatoryIteration")),~df.claves.Cpp.1.1.entropia[[sub("AleatoryIteration", "GreedyPassword", cur_column())]]),
across(all_of(paste0(tipos.entropia, "GreedyPassword")),~df.claves.Cpp.1.1.entropia[[sub("GreedyPassword", "AleatoryIteration", cur_column())]]),
Tiempo_Hybrid = Tiempo_AleatoryGen,
Tiempo_AleatoryGen = Tiempo_Hybrid,
Tiempo_AleatoryIter = Tiempo_Greedy,
Tiempo_Greedy = Tiempo_AleatoryIter,
HybridFunction = AleatoryGeneration,
AleatoryGeneration = HybridFunction,
AleatoryIteration = GreedyPassword,
GreedyPassword = AleatoryIteration
) %>%
rename_with(~sub("HybridFunction", "AleatoryGeneration_tmp", .x),
all_of(paste0(tipos.entropia, "HybridFunction"))) %>%
rename_with(~sub("AleatoryGeneration", "HybridFunction", .x),
all_of(paste0(tipos.entropia, "AleatoryGeneration"))) %>%
rename_with(~sub("AleatoryGeneration_tmp", "AleatoryGeneration", .x),
all_of(paste0(tipos.entropia, "AleatoryGeneration_tmp"))) %>%
rename_with(~sub("AleatoryIteration", "GreedyPassword_tmp", .x),
all_of(paste0(tipos.entropia, "AleatoryIteration"))) %>%
rename_with(~sub("GreedyPassword", "AleatoryIteration", .x),
all_of(paste0(tipos.entropia, "GreedyPassword"))) %>%
rename_with(~sub("GreedyPassword_tmp", "GreedyPassword", .x),
all_of(paste0(tipos.entropia, "GreedyPassword_tmp")))
resumen.df <- function(df) {
num.cols <- df[sapply(df, is.numeric)]
estadisticas <- rbind(
media       = colMeans(num.cols, na.rm = TRUE),
mediana     = apply(num.cols, 2, median, na.rm = TRUE),
desviacion  = apply(num.cols, 2, sd, na.rm = TRUE),
minimo      = apply(num.cols, 2, min, na.rm = TRUE),
maximo      = apply(num.cols, 2, max, na.rm = TRUE),
rango       = apply(num.cols, 2, function(x) diff(range(x, na.rm = TRUE))),
Q1          = apply(num.cols, 2, quantile, probs = 0.25, na.rm = TRUE),
Q3          = apply(num.cols, 2, quantile, probs = 0.75, na.rm = TRUE),
NA.contador = apply(num.cols, 2, function(x) sum(is.na(x)))
)
resumen <- data.frame(
datos = rownames(estadisticas),
estadisticas,
check.names = FALSE
)
return(resumen)
}
df.R.1.1.resumen          <- resumen.df(df.R.1.1.entropia)
df.Cpp.1.1.resumen        <- resumen.df(df.Cpp.1.1.entropia)
df.claves.R.1.1.resumen   <- resumen.df(df.claves.R.1.1.entropia)
df.claves.Cpp.1.1.resumen <- resumen.df(df.claves.Cpp.1.1.entropia)
View(df.Cpp.1.1.resumen)
View(df.R.1.1.resumen)
